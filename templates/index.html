<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CircuitGuard - PCB Defect Detection</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <header class="header">
        <h1>üß† CircuitGuard</h1>
        <p>AI-powered PCB Defect Detection using EfficientNet-B4</p>
    </header>

    <main class="container">
        <!-- Upload Section -->
        <section class="upload-section card">
            <h2>Upload Images</h2>
            <div class="upload-grid">
                <div class="upload-box">
                    <label>Template Image</label>
                    <input type="file" id="template_image" accept="image/*" required>
                    <img id="template-preview" class="preview" src="#" alt="Template Preview" style="display:none;">
                </div>
                <div class="upload-box">
                    <label>Test Image</label>
                    <input type="file" id="test_image" accept="image/*" required>
                    <img id="test-preview" class="preview" src="#" alt="Test Preview" style="display:none;">
                </div>
            </div>
        </section>

        <!-- Parameters Section -->
        <section class="params-section card">
            <h2>Detection Parameters</h2>
            <div class="slider-container">
                <label for="diff-threshold">Difference Threshold: <span id="diff-value">30</span></label>
                <input type="range" id="diff-threshold" min="0" max="100" value="30">
            </div>
            <div class="slider-container">
                <label for="roi-area">Minimum ROI Area: <span id="roi-value">50</span></label>
                <input type="range" id="roi-area" min="10" max="200" value="50">
            </div>
            <div class="slider-container">
                <label for="conf-threshold">Confidence Threshold: <span id="conf-value">0.6</span></label>
                <input type="range" id="conf-threshold" min="0" max="1" step="0.01" value="0.6">
            </div>
        </section>

        <!-- Detect Button -->
        <div class="action-container">
            <button id="detect-button" class="btn-primary">üöÄ Detect Defects</button>
            <div id="spinner" class="spinner" style="display:none;">Processing...</div>
        </div>

        <!-- Results Section -->
        <section id="results-section" class="results-section card" style="display:none;">
            <h2>Defect Summary</h2>
            <p id="defect-count">Detected Defects: 0</p>

            <div id="defect-table-container">
                <table id="defect-table">
                    <thead>
                        <tr><th>ID</th><th>Region</th><th>Confidence</th></tr>
                    </thead>
                    <tbody id="defect-table-body">
                        <tr><td colspan="3"><em>Awaiting results...</em></td></tr>
                    </tbody>
                </table>
            </div>

            <div class="result-image-container">
                <h3>Annotated Image</h3>
                <img id="result-image" src="#" alt="Annotated Result" style="display:none;">
                <a id="download-link" class="btn-download" href="#" download style="display:none;">‚¨áÔ∏è Download Annotated Image</a>
            </div>
        </section>
    </main>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
